{#
  Render the NCIDS Dynamic Lists.

  Used in:
    * NCIDS 2 Column Container (Dynamic Lists as a field)
    * NCIDS Dynamic Lists
#}
{% macro ncids_dynamic_list_macro(title, date, description = '', image, url) %}
  <li class="usa-collection__item">
    {% set renderImage = image|render %}
    {% if renderImage is not empty %}
      {{- image -}}
    {% endif %}
    <div class="usa-collection__body">
      <h3 class="usa-collection__heading">
        <a class="usa-link" href="{{ url }}">
          {{ title }}
        </a>
      </h3>
      <ul class="usa-collection__meta">
        <li class="usa-collection__meta-item">
          {{ date }}
        </li>
      </ul>
      {% if description is not empty %}
        <p class="usa-collection__description">{{ description }}</p>
      {% endif %}
    </div>
  </li>
{% endmacro %}

{% macro ncids_list_macro(title, description, url, style, image, media_type, file_type, file_size, file_ext, external_link_display) %}
  <li class="usa-collection__item" data-list-component-variant="{{ style }}">
    {% if style == "Title, Description, and Image" %}
      {% set renderImage = image|render %}
      {% if renderImage %}
        {{- image -}}
      {% else %}
        <img class="usa-collection__img" src="{{ get_placeholder_image('ncids_collections_media_4x3') }}" alt="No Image Placeholder">
      {% endif %}
    {% endif %}
    <div class="usa-collection__body">
      <h3 class="usa-collection__heading">
        {% set link_attributes = create_attribute() %}
          {% if (external_link_display == 'do_not_display') %}
            {% set link_attributes = link_attributes.setAttribute('data-ncids-internal-link', true) %}
          {% endif %}
        {% set link_classes = create_attribute({'class': ['usa-link']}) %}
          {% if (external_link_display == 'force_display') %}
            {% set link_classes = link_classes.addClass('usa-link--external') %}
          {% endif %}
        <a {{ link_classes }} href="{{ url }}" {{ link_attributes }}>
          {{- title -}}
        </a>
        {% if media_type == "Video" or media_type == "Infographic" %}
           ({{ media_type }})
        {% elseif media_type == "File" %}
          <span class="filetype {{file_type}}">
            {% if file_type != "unknown" %}
              {# Note, the spanish should have the word order reversed... #}
              <span class="usa-sr-only">{{ file_type }} {% trans %}file{% endtrans %}</span>
            {% else %}
              {{ file_ext }}<span class="usa-sr-only"> {% trans %}file{% endtrans %}</span>
            {% endif %}
          </span>
          <span class="filesize">({{ file_size }})</span>
        {% endif %}
      </h3>
      <p class="usa-collection__description">{{ description }}</p>
    </div>
  </li>
{% endmacro %}

{% macro ncids_dynamic_list_event_macro(title, startDate, endDate, description = '', url, series = '', allDay = '', venue = '', room = '', cityState = '') %}
  {% set eventStart = startDate[0]['#attributes']["datetime"] %}
  {% set eventEnd = endDate[0]['#attributes']["datetime"] %}
  {% set isMultiDayEvent = eventStart|date('Y-m-d') < eventEnd|date('Y-m-d') %}
  {% set isMultiYearEvent = eventStart|date('Y') <  eventEnd|date('Y') %}
  <li class="usa-collection__item">
    <div class="usa-collection__body">
      {# Title #}
      <h3 class="usa-collection__heading">
        <a class="usa-link" href="{{ url }}">
          {{ title }}
        </a>
      </h3>
      <ul class="usa-collection__meta">
        <li class="usa-collection__meta-item">
          {# Series name #}
          {% if series|field_value %}
            <strong>{{ series }}</strong>
            <br />
          {% endif %}
          {# Date/time range #}
          {% if isMultiDayEvent %}
            {% if isMultiYearEvent %}
              {{ eventStart|date('F j, Y') }}
              &ndash;
              {{ eventEnd|date('F j, Y') }}
            {% else %}
              {{ eventStart|date('F j') }}
              &ndash;
              {{ eventEnd|date('F j, Y') }}
            {% endif %}
          {% else %}
            {{ eventStart|date('F j, Y') }}
            {% if allDay != "On" %}
              &vert;
              {{ eventStart|date('g:i A') }}
              &ndash;
              {{ eventEnd|date('g:i A') }}
            {% endif %}
          {% endif %}
          <br />
          {# Location info #}
          {% if venue|field_value or room|field_value or cityState|field_value %}
              {% if venue|field_value %}
                {{ venue }}
              {% endif %}
              {% if room|field_value %}
                {{ room }}
              {% endif %}
              {% if cityState|field_value %}
                {{ cityState }}
              {% endif %}
          {% endif %}
        </li>
      </ul>
      {# List description #}
      {% if description is not empty %}
        <p class="usa-collection__description">{{ description }}</p>
      {% endif %}
    </div>
  </li>
{% endmacro %}

{% macro ncids_list_item_related_resource(title, url, link_type, media_type = null, file_type = null, file_size = null, file_ext = null) %}
  {% if media_type == "Video" or media_type == "Infographic" or media_type == "File" %}
  <li class="cgdp-media-link">
  {% else %}
  <li>
  {% endif %}
    <a class="usa-link" href='{{ url }}' data-list-item-type="{{ link_type }}">{{ title }}</a>
    {% if media_type == "Video" or media_type == "Infographic" %}
      <span class="cgdp-media-link__mediatype">({{ media_type }})</span>
    {% elseif media_type == "File" %}
      <span class="cgdp-media-link__filetype {{file_type}}">
        {% if file_type != "unknown" %}
          {# Note, the spanish should have the word order reversed... #}
          <span class="usa-sr-only">{{ file_type }} {% trans %}file{% endtrans %}</span>
        {% else %}
          {{ file_ext }}<span class="usa-sr-only"> {% trans %}file{% endtrans %}</span>
        {% endif %}
      </span>
      <span class="cgdp-media-link__filesize">({{ file_size }})</span>
    {% endif %}
  </li>
{% endmacro %}
